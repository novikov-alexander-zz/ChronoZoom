var CZ;(function(n){(function(t){function e(){t.ax=$("#axis");t.axis=new n.Timescale(t.ax);n.VirtualCanvas.initialize();t.vc=$("#vc");t.vc.virtualCanvas()}function o(n){typeof n!="string"&&(n=window.location.pathname);var t=n.toLowerCase().replace("/czmin","").split("#")[0];return $.inArray(t,["/","/chronozoom","/chronozoom/","/chronozoom/cosmos","/chronozoom/cosmos/"])>-1}function s(n,t){var i,r;return i=t.pageX-n[0].offsetLeft,r=t.pageY-n[0].offsetTop,{x:i,y:r}}function h(n){return n*n}function c(n){n&&n.stopPropagation?n.stopPropagation():n.cancelBubble=!0}function l(n,t){var u;t||(t="jpg");var i=$("#"+n).attr("src"),r=i.length,f=i.substring(0,r-7);i.substring(r-6,r-4)=="on"&&(u=f+"_off."+t,$("#"+n).attr("src",u))}function a(n,t){var u;t||(t="jpg");var i=$("#"+n).attr("src"),r=i.length,f=i.substring(0,r-7);i.substring(r-6,r-4)=="ff"&&(u=f+"on."+t,$("#"+n).attr("src",u))}function v(){$("#footerBack").show("clip",{},"slow")}function y(){t.animationTooltipRunning!=null&&($(".bubbleInfo").stop(),$(".bubbleInfo").css("opacity","0.9"),$(".bubbleInfo").css("filter","alpha(opacity=90)"),$(".bubbleInfo").css("-moz-opacity","0.9"),t.animationTooltipRunning=null,$(".bubbleInfo").attr("id","defaultBox"),$(".bubbleInfo").hide())}function p(t,i){return i!=null?Math.abs(t.centerX-i.centerX)<n.Settings.allowedVisibileImprecision&&Math.abs(t.centerY-i.centerY)<n.Settings.allowedVisibileImprecision&&Math.abs(t.scale-i.scale)<n.Settings.allowedVisibileImprecision:!1}function w(t){return n.Tours.pauseTourAtAnyAnimation=!1,n.Tours.tour!=undefined&&n.Tours.tour.state=="play"&&n.Tours.tourPause(),i(t)}function i(n){if(n)return t.controller.moveToVisible(n)}function b(){t.axis.setTimeMarker(t.vc.virtualCanvas("getCursorPosition"),!0)}function k(){return n.Data.getTimelines(null).then(function(i){if(i){var r=t.vc.virtualCanvas("getLayerContent");r.beginEdit();n.Layout.Merge(i,r);r.endEdit(!0);t.vc.virtualCanvas("updateViewport")}})}function d(){return n.Data.getTimelines(null).then(function(i){i&&(g(i),t.vc.virtualCanvas("updateViewport"),n.Common.initialContent&&n.Service.getContentPath(n.Common.initialContent).then(function(n){window.location.hash=n},function(n){console.log("Error connecting to service:\n"+n.responseText)}),n.Service.getTours().then(function(t){n.Tours.parseTours(t);n.Tours.initializeToursContent()},function(n){console.log("Error connecting to service:\n"+n.responseText)}))},function(n){console.log("Error connecting to service:\n"+n.responseText)})}function g(i){var f=t.vc.virtualCanvas("getLayerContent"),e;f.beginEdit();n.Layout.Merge(i,f);f.endEdit(!0);nt(i);t.startHash&&(r=n.UrlNav.navStringToVisible(t.startHash.substring(1),t.vc));!r&&t.cosmosVisible&&(window.location.hash=t.cosmosVisible,r=n.UrlNav.navStringToVisible(t.cosmosVisible,t.vc));r&&(t.controller.moveToVisible(r,!0),u(t.vc,t.ax),e=t.vc.virtualCanvas("getViewport"),t.startHash&&window.location.hash!==t.startHash&&(hashChangeFromOutside=!1,window.location.hash=t.startHash))}function nt(r){var e=function(i){if(!i)return null;var r=t.vc.virtualCanvas("findElement","t"+i.id);return f.push(r),r&&(r=n.UrlNav.vcelementToNavString(r)),r},u=r,o,s,h,c;t.cosmosVisible=e(u);n.UrlNav.navigationAnchor=t.vc.virtualCanvas("findElement","t"+u.id);$("#regime-link-cosmos").click(function(){var r=n.UrlNav.navStringToVisible(t.cosmosVisible,t.vc);i(r)});o=n.Layout.FindChildTimeline(u,n.Settings.earthTimelineID,!0);typeof o!="undefined"&&(t.earthVisible=e(o),$("#regime-link-earth").click(function(){var r=n.UrlNav.navStringToVisible(t.earthVisible,t.vc);i(r)}),s=n.Layout.FindChildTimeline(o,n.Settings.lifeTimelineID,!1),typeof s!="undefined"&&(t.lifeVisible=e(s),$("#regime-link-life").click(function(){var r=n.UrlNav.navStringToVisible(t.lifeVisible,t.vc);i(r)}),h=n.Layout.FindChildTimeline(s,n.Settings.prehistoryTimelineID,!1),typeof h!="undefined"&&(t.prehistoryVisible=e(h),$("#regime-link-prehistory").click(function(){var r=n.UrlNav.navStringToVisible(t.prehistoryVisible,t.vc);i(r)}),c=n.Layout.FindChildTimeline(h,n.Settings.humanityTimelineID,!0),typeof c!="undefined"&&(t.humanityVisible=e(c),$("#regime-link-humanity").click(function(){var r=n.UrlNav.navStringToVisible(t.humanityVisible,t.vc);i(r)})))));t.maxPermitedVerticalRange={top:u.y,bottom:u.y+u.height};n.Settings.maxPermitedTimeRange={left:u.left,right:u.right};t.maxPermitedScale=n.UrlNav.navStringToVisible(t.cosmosVisible,t.vc).scale*1.1}function tt(){n.BreadCrumbs.visibleAreaWidth=$(".breadcrumbs-container").width();n.BreadCrumbs.updateHiddenBreadCrumbs();t.vc.virtualCanvas("updateViewport");u(t.vc,t.ax);n.BreadCrumbs.updateBreadCrumbsLabels()}function u(n){var i=n.virtualCanvas("getViewport"),r=i.pointScreenToVirtual(0,0),u=i.pointScreenToVirtual(i.width,i.height),f={min:r.x,max:u.x};t.axis.update(f)}function it(n,t,i){var r=new Date,u;r.setDate(r.getDate()+i);u=escape(t)+(i==null?"":"; expires="+r.toUTCString());document.cookie=n+"="+u}function rt(n){for(var r,u,i=document.cookie.split(";"),t=0;t<i.length;t++)if(r=i[t].substr(0,i[t].indexOf("=")),u=i[t].substr(i[t].indexOf("=")+1),r=r.replace(/^\s+|\s+$/g,""),r==n)return unescape(u);return null}function ut(n){var t=n.widthScreenToVirtual(n.width),i=n.heightScreenToVirtual(n.height),r=n.visible.centerX-t/2,u=n.visible.centerY-i/2;return{left:r,right:r+t,top:u,bottom:u+i,width:t,height:i,centerX:n.visible.centerX,centerY:n.visible.centerY,scale:n.visible.scale}}var r;t.maxPermitedScale;t.maxPermitedVerticalRange={top:0,bottom:1e7};t.controller;t.isAxisFreezed=!0;t.startHash;t.ax;t.axis;t.vc;t.cosmosVisible;t.earthVisible;t.lifeVisible;t.prehistoryVisible;t.humanityVisible;var f=[];t.setNavigationStringTo;t.hashHandle=!0;t.supercollection="";t.collection="";t.collectionTitle="";t.initialContent=null;t.initialize=e;t.isInCosmos=o;t.getXBrowserMouseOrigin=s;t.sqr=h;t.preventbubble=c;t.toggleOffImage=l;t.toggleOnImage=a;t.showFooter=v;t.animationTooltipRunning=null;t.tooltipMode="default";t.stopAnimationTooltip=y;t.compareVisibles=p;t.setVisibleByUserDirectly=w;t.setVisible=i;t.updateMarker=b;t.reloadData=k;t.loadData=d;t.updateLayout=tt;t.updateAxis=u;t.setCookie=it;t.getCookie=rt;t.viewportToViewBox=ut})(n.Common||(n.Common={}));var t=n.Common})(CZ||(CZ={}));
//# sourceMappingURL=common.min.js.map
